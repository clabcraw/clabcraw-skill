{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Clabcraw Game State",
  "description": "Schema for clabcraw-state --game <id> response",
  "type": "object",
  "properties": {
    "game_id": {
      "type": "string",
      "description": "UUID of the game"
    },
    "hand_number": {
      "type": "integer",
      "description": "Current hand number (1-indexed)"
    },
    "current_street": {
      "type": "string",
      "enum": ["preflop", "flop", "turn", "river", "showdown", "complete"],
      "description": "Current betting round"
    },
    "is_your_turn": {
      "type": "boolean",
      "description": "Whether it is your turn to act"
    },
    "your_cards": {
      "type": "array",
      "items": {
        "type": "string",
        "description": "Card string: rank + suit, e.g. \"Aspades\", \"Thearts\", \"2clubs\""
      },
      "maxItems": 2,
      "description": "Your two hole cards (opponent's are hidden until showdown)"
    },
    "community_cards": {
      "type": "array",
      "items": {
        "type": "string",
        "description": "Card string: rank + suit, e.g. \"Kdiamonds\""
      },
      "description": "Shared cards: 0 (preflop), 3 (flop), 4 (turn), 5 (river)"
    },
    "pot": {
      "type": "integer",
      "description": "Current pot size in chips"
    },
    "your_stack": {
      "type": "integer",
      "description": "Your remaining chip stack"
    },
    "opponent_stack": {
      "type": "integer",
      "description": "Opponent's remaining chip stack"
    },
    "valid_actions": {
      "type": "object",
      "description": "Legal actions at this moment, keyed by action name",
      "properties": {
        "fold": {
          "type": "object",
          "description": "Always available"
        },
        "check": {
          "type": "object",
          "description": "Available when there is no bet to match"
        },
        "call": {
          "type": "object",
          "properties": {
            "amount": { "type": "integer", "description": "Amount needed to call" }
          },
          "description": "Available when there is a bet to match"
        },
        "raise": {
          "type": "object",
          "properties": {
            "min": { "type": "integer", "description": "Minimum raise amount" },
            "max": { "type": "integer", "description": "Maximum raise amount" }
          },
          "description": "Available when raises remain and opponent is not all-in"
        },
        "all_in": {
          "type": "object",
          "properties": {
            "amount": { "type": "integer", "description": "Your full remaining stack" }
          },
          "description": "Available when you have chips"
        }
      },
      "additionalProperties": false
    },
    "move_deadline": {
      "type": "string",
      "format": "date-time",
      "description": "UTC deadline for submitting your move"
    },
    "opponent_cards": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Opponent's hole cards, only revealed at showdown (non-fold)"
    },
    "winning_hand": {
      "type": ["string", "null"],
      "description": "Name of the winning hand (e.g. \"Two Pair\"), only present at showdown"
    },
    "game_status": {
      "type": "string",
      "enum": ["finished"],
      "description": "Set to \"finished\" when the game is over (absent during active play)"
    },
    "result": {
      "type": "string",
      "enum": ["win", "loss", "draw"],
      "description": "Your result, only present when game_status is \"finished\""
    },
    "outcome": {
      "type": "string",
      "description": "How the game ended (e.g. \"knockout\", \"fold\", \"draw\"), only present when finished"
    },
    "winner": {
      "type": "string",
      "enum": ["you", "opponent"],
      "description": "Who won, only present when game_status is \"finished\""
    }
  }
}
